<!DOCTYPE html>
<html lang="en">
  <meta charset="utf-8" />
  <head>
    <title>load-grunt-config - Modularize your Gruntfile</title>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="public/common.css"/>
    
      <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-24017782-2']);
        _gaq.push(['_trackPageview']);

        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

      </script>
    
  </head>
  <body>
    <div id="toc"></div>
    
      <a class="ribbon" data-clickd-action="Fork" href="http://github.com/firstandthird/load-grunt-config"><img src="public/ribbon.png" alt="Fork me on GitHub"></a>
    
    <div class="wrapper">
      
      
      <a href="https://twitter.com/share" class="twitter-share-button" data-text="load-grunt-config - Modularize your Gruntfile" >Tweet</a>
      
      <h1>load-grunt-config</h1>
<p>load-grunt-config is a Grunt library that allows you to break up your Gruntfile config by task.  For most small projects a single Gruntfile.js is perfect. But as a project grows, the Gruntfile.js can quickly become unmanagable; this is where load-grunt-config comes in handy.  It was heavily inspired by <a href="http://www.thomasboyt.com/2013/09/01/maintainable-grunt.html">Thomas Boyt&#39;s &quot;More Maintainable Gruntfiles&quot;</a>.

</p>
<h2>Features</h2>
<ul>
<li>Each task has its own config file. Example: jshint.js, mocha.js, etc.</li>
<li>Auto load all grunt plugins.  Uses <a href="https://github.com/sindresorhus/load-grunt-tasks">load-grunt-tasks</a>. (Optionally it can use <a href="https://github.com/shootaroo/jit-grunt">jit-grunt</a>)</li>
<li>Auto expose package.json (<code>&lt;%= package.name %&gt;</code>).</li>
<li>Support for YAML files.</li>
<li>Support for CSON files.</li>
<li>Support for coffeescript files.</li>
<li>Support for returning a function.</li>
<li><a href="#aliases">Easily register task aliases</a> with <code>aliases.(js|json|yaml|coffee)</code>.</li>
<li><a href="#custom-config">Config overrides</a></li>
<li><a href="#config-grouping">Config grouping</a></li>
</ul>
<h2>Installation</h2>
<pre><code class="lang-bash">npm install -D load-grunt-config</code></pre>
<h2>Example</h2>
<p>Basic Gruntfile.js
</p>
<pre><code class="lang-javascript">module.exports = <span class="function"><span class="keyword">function</span><span class="params">(grunt)</span> {</span>

    require(<span class="string">'load-grunt-config'</span>)(grunt);

};</code></pre>
<p>Gruntfile.js with options
</p>
<pre><code class="lang-javascript">module.exports = <span class="function"><span class="keyword">function</span><span class="params">(grunt)</span> {</span>
    <span class="keyword">var</span> path = require(<span class="string">'path'</span>);

    require(<span class="string">'load-grunt-config'</span>)(grunt, {
        <span class="comment">// path to task.js files, defaults to grunt dir</span>
        configPath: path.join(process.cwd(), <span class="string">'grunt'</span>),

        <span class="comment">// auto grunt.initConfig</span>
        init: <span class="literal">true</span>,

        <span class="comment">// data passed into config.  Can use with &lt;%= test %&gt;</span>
        data: {
            test: <span class="literal">false</span>
        },

        <span class="comment">// use different function to merge config files</span>
        mergeFunction: require(<span class="string">'recursive-merge'</span>)

        <span class="comment">// can optionally pass options to load-grunt-tasks.</span>
        <span class="comment">// If you set to false, it will disable auto loading tasks.</span>
        loadGruntTasks: {

            pattern: <span class="string">'grunt-*'</span>,
            config: require(<span class="string">'./package.json'</span>),
            scope: <span class="string">'devDependencies'</span>
        },

        <span class="comment">//can post process config object before it gets passed to grunt</span>
        postProcess: <span class="function"><span class="keyword">function</span><span class="params">(config)</span> {</span>},

        <span class="comment">//allows to manipulate the config object before it gets merged with the data object</span>
        preMerge: <span class="function"><span class="keyword">function</span><span class="params">(config, data)</span> {</span>}
    });

};</code></pre>
<p>Optionally you can use <a href="https://github.com/shootaroo/jit-grunt">jit-grunt</a> instead of <a href="https://github.com/sindresorhus/load-grunt-tasks">load-grunt-tasks</a>
</p>
<pre><code class="lang-javascript">module.exports = <span class="function"><span class="keyword">function</span><span class="params">(grunt)</span> {</span>

    require(<span class="string">'load-grunt-config'</span>)(grunt, {
        <span class="comment">// ...</span>
        jitGrunt: {
            <span class="comment">// here you can pass options to jit-grunt (or just jitGrunt: true)</span>
            staticMappings: {
                <span class="comment">// here you can specify static mappings, for example:</span>
                sprite: <span class="string">'grunt-spritesmith'</span>,
                hello: <span class="string">'custom/say-hello.js'</span>
            }
        }
    });

};</code></pre>
<p>Note: if you have problems with auto loading of some tasks please check <a href="https://github.com/shootaroo/jit-grunt#static-mappings">jit-grunt#static-mappings</a>

</p>
<h3>Grunt tasks files</h3>
<p>Here&#39;s what the files in your <code>grunt/</code> folder could look like.  You can use either .js, .json, .yaml, .cson, or .coffee - whatever you prefer and you can mix and match as you see fit.

</p>
<p>Example js file returning an object - <code>grunt/watch.js</code>
</p>
<pre><code class="lang-javascript">module.exports = {
  all: {
    files: [
      <span class="string">'&lt;%= jshint.all %&gt;'</span>,
      <span class="string">'grunt/*.yaml'</span>
    ],
    tasks: [
      <span class="string">'default'</span>
    ]
  }
};</code></pre>
<p>Example js file returning a function - <code>grunt/jshint.js</code>
</p>
<pre><code class="lang-javascript">module.exports = <span class="function"><span class="keyword">function</span> <span class="params">(grunt, options)</span> {</span>
  <span class="keyword">return</span> {
    all: [
      <span class="string">'Gruntfile.js'</span>,
      <span class="string">'grunt/*.js'</span>,
      <span class="string">'lib/*.js'</span>,
      <span class="string">'test/*.js'</span>,
      options.someFile
    ]
  };
};</code></pre>
<p>Example json file - <code>grunt/clean.json</code>
</p>
<pre><code class="lang-json">{
  "<span class="attribute">all</span>": <span class="value">[
    <span class="string">"&lt;%= project.dest %&gt;"</span>,
    <span class="string">"target/*.js"</span>
  ]
</span>}</code></pre>
<p>Example yaml file - <code>grunt/notify.yaml</code>
</p>
<pre><code class="lang-yaml"><span class="method">default:</span>
  <span class="method">options:</span>
    <span class="method">message:</span> <span class="string">'Default finished'</span></code></pre>
<p>Example coffee file - <code>grunt/task.coffee</code>
</p>
<pre><code class="lang-coffee">module.<span class="built_in">exports</span> =
  <span class="attribute">options</span>:
    <span class="attribute">bare</span>: <span class="literal">true</span></code></pre>
<h3>Aliases</h3>
<p>If your <code>grunt/</code> folder contains an <code>aliases.(js|.json|yaml|cson|coffee)</code> file, <code>load-grunt-config</code> will use that to define your tasks aliases (like <code>grunt.registerTask(&#39;default&#39;, [&#39;jshint&#39;]);</code>).

</p>
<p>The following examples show the same <code>aliasses</code> definition written in various formats

</p>
<p>Example yaml file - <code>grunt/aliases.yaml</code>
</p>
<pre><code class="lang-yaml"><span class="attribute">default</span>: <span class="string">[]</span>

<span class="vhdl">lint:
  description: <span class="attribute">'Helps</span> <span class="keyword">to</span> make our code better'
  tasks:
    - <span class="attribute">'jshint</span>'
    - <span class="attribute">'csslint</span>'

build:
  - <span class="attribute">'lint</span>'
  - <span class="attribute">'mocha</span>'
  - <span class="attribute">'notify</span>'</span></code></pre>
<p>Example json file - <code>grunt/aliases.json</code>
</p>
<pre><code class="lang-json">{
  "<span class="attribute">default</span>": <span class="value">[]</span>,
  "<span class="attribute">lint</span>": <span class="value">[
    <span class="string">"jshint"</span>,
    <span class="string">"csslint"</span>
  ]</span>,
  "<span class="attribute">build</span>": <span class="value">[
    <span class="string">"lint"</span>,
    <span class="string">"mocha"</span>,
    <span class="string">"notify"</span>
  ]
</span>}</code></pre>
<p>Example JavaScript file returning an object - <code>grunt/aliases.js</code>
</p>
<pre><code class="lang-javascript">module.exports = {
  <span class="string">'default'</span>: [],
  <span class="string">'lint'</span>: [
    <span class="string">'jshint'</span>,
    <span class="string">'csslint'</span>
  ],
  <span class="string">'build'</span>: [
    <span class="string">'lint'</span>,
    <span class="string">'mocha'</span>,
    <span class="string">'notify'</span>
  ]
};</code></pre>
<p>Example JavaScript file returning a function <code>grunt/aliases.js</code>
Useful if there is need to compute something before return.

</p>
<pre><code class="lang-javascript">module.exports = <span class="function"><span class="keyword">function</span> <span class="params">(grunt, options)</span> {</span>
  <span class="comment">// computation...</span>
  <span class="keyword">return</span> {
    <span class="string">'default'</span>: [],
    <span class="string">'lint'</span>: [
      <span class="string">'jshint'</span>,
      <span class="string">'csslint'</span>
    ],
    <span class="string">'build'</span>: [
      <span class="string">'lint'</span>,
      <span class="string">'mocha'</span>,
      <span class="string">'notify'</span>
    ]
  };
};</code></pre>
<p>Example coffee file grunt/aliases.coffee
</p>
<pre><code class="lang-coffee">module.exports =
  <span class="keyword">default</span>: []
  lint: [
    <span class="comment">'jshint'</span>
    <span class="comment">'csslint'</span>
  ]
  build: [
    <span class="comment">'lint'</span>
    <span class="comment">'mocha'</span>
    <span class="comment">'notify'</span>
  ]</code></pre>
<p>You can specify a task description - example JavaScript file <code>grunt/aliases.js</code>
</p>
<pre><code class="lang-javascript">module.exports = {
  <span class="string">'lint'</span>: {
    description: <span class="string">'Lint css and js'</span>,
    tasks: [
      <span class="string">'jshint'</span>,
      <span class="string">'csslint'</span>
    ]
  }
};</code></pre>
<h3>Custom Config</h3>
<p>There are certain scenarios where you might have a base config for your team, and you want to be able to override some of the config based on your personal setup.  You can do that with the <code>overridePath</code> property.  In this case, the library will merge the two, with the override path taking priority.  For example:

</p>
<pre><code class="lang-javascript">module.exports = <span class="function"><span class="keyword">function</span><span class="params">(grunt)</span> {</span>
  <span class="keyword">var</span> path = require(<span class="string">'path'</span>);

  require(<span class="string">'load-grunt-config'</span>)(grunt, {
    configPath: path.join(process.cwd(), <span class="string">'vendor'</span>),
    overridePath: path.join(process.cwd(), <span class="string">'config-'</span>+process.env.USER)
  });

};</code></pre>
<p><code>configPath</code> and <code>overridePath</code> accept single string as well as array of strings.  It means that you can compose config using multiple folders.  For example:

</p>
<pre><code class="lang-javascript">module.exports = <span class="function"><span class="keyword">function</span><span class="params">(grunt)</span> {</span>
  <span class="keyword">var</span> path = require(<span class="string">'path'</span>);

  require(<span class="string">'load-grunt-config'</span>)(grunt, {
    configPath: [
      path.join(process.cwd(), <span class="string">'vendor'</span>),
      path.join(process.cwd(), <span class="string">'base-target'</span>)
    ],
    overridePath: [
      path.join(process.cwd(), <span class="string">'variant-1'</span>),
      path.join(process.cwd(), <span class="string">'variant-n'</span>)
    ]
  });

};</code></pre>
<h3>Config Grouping</h3>
<p><code>load-grunt-config</code> also supports grouping tasks.  This is handy when you want to group all of your script or css tasks together.  To do that, just add the suffix <code>-tasks</code> to your config filename and <code>load-grunt-config</code> will treat the filename as the task target and the top level keys as the task names.

</p>
<p>Here&#39;s an example

</p>
<p>Filename: <code>/config/scripts-tasks.yaml</code>
</p>
<pre><code class="lang-yaml"><span class="method">jshint:</span>
  <span class="method">files:</span>
    - <span class="string">'*.js'</span>
<span class="method">jshint__test:</span>
  <span class="method">files:</span>
    - <span class="string">'test/*.js'</span>
<span class="method">watch:</span>
  <span class="method">files:</span>
    - <span class="string">'*.js'</span>
  <span class="method">tasks:</span>
    - <span class="string">'scripts'</span></code></pre>
<p>This would be the equivalent in your <code>Gruntfile.js</code>:
</p>
<pre><code class="lang-javascript">{
  jshint: {
    scripts: {
      files: [
        <span class="string">'*.js'</span>
      ]
    },
    scripts_test: {
      files: [
        <span class="string">'test/*.js'</span>
      ]
    }
  },
  watch: {
    scripts: {
      files: [
        <span class="string">'*.js'</span>
      ],
      tasks: [
        <span class="string">'scripts'</span>
      ]
    }
  }
}</code></pre>
<h3>Debugging</h3>
<p>If you pass the parameter <code>--config-debug</code>, <code>load-grunt-config</code> will output the whole object it will pass
to Grunt, which can be useful for debugging purposes or when asking for help.

</p>
<p>Note that this won&#39;t run grunt at all and no tasks would be run, nor loaded.
</p>

      <div class="footer">
        <div class="built-with">Built with <a href="https://github.com/jgallen23/ghpage">ghpage</a></div>
        
          First + Third
          
        
      </div>
    </div>
    <script src="public/common.js"></script>
    
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
    
  </body>
</html>
